# HomeLab PWA

A minimalistic Next.js Progressive Web App boilerplate with:

- **Installable PWA** - Add to home screen on mobile/desktop
- **Share Sheet (Android)** - Share content from your app via Web Share API
- **Share Target** - Receive shared content from other apps
- **Push Notifications** - Send and receive push notifications
- **Offline Support** - Service worker with caching

## Getting Started

```bash
# Install dependencies
npm install

# Run development server
npm run dev

# Build for production (generates service worker)
npm run build

# Start production server
npm start
```

## Features

### Share Sheet (Outgoing)

Use the Web Share API to share content from your app:

```typescript
import { share, canShare } from "@/lib/share";

if (canShare()) {
  await share({
    title: "Check this out",
    text: "Some interesting content",
    url: "https://example.com",
  });
}
```

### Share Target (Incoming)

The app is configured to receive shared content from other apps on Android. When content is shared to this app, it's handled by `/share-target` and redirected to the home page with query parameters.

Configure share target in `public/manifest.json`:

```json
{
  "share_target": {
    "action": "/share-target",
    "method": "POST",
    "enctype": "multipart/form-data",
    "params": {
      "title": "title",
      "text": "text",
      "url": "url",
      "files": [{ "name": "files", "accept": ["image/*", "*/*"] }]
    }
  }
}
```

### Push Notifications

Enable push notifications in your app:

```typescript
import { subscribeToPushNotifications } from "@/lib/push-notifications";

// Your VAPID public key (generate with: npx web-push generate-vapid-keys)
const PUBLIC_VAPID_KEY = "your-public-key";

const subscription = await subscribeToPushNotifications(PUBLIC_VAPID_KEY);
// Send subscription to your server
```

### Generating VAPID Keys

For push notifications to work in production, generate VAPID keys:

```bash
npx web-push generate-vapid-keys
```

Store the private key securely on your server and use the public key in the client.

## PWA Configuration

### Manifest

Edit `public/manifest.json` to customize your app's name, colors, and icons.

### Icons

Generate new icons by placing your source image and running:

```bash
npm run generate-icons
```

Or edit `scripts/generate-icons.js` to customize the icon generation.

### Service Worker

The service worker is generated by `next-pwa` during build. Custom service worker code can be added to `public/custom-sw.js`.

## Project Structure

```
├── public/
│   ├── manifest.json          # PWA manifest
│   ├── custom-sw.js           # Custom service worker extensions
│   └── icons/                 # App icons
├── src/
│   ├── app/
│   │   ├── layout.tsx         # Root layout with PWA metadata
│   │   ├── page.tsx           # Home page
│   │   └── share-target/      # Share target handler
│   ├── lib/
│   │   ├── push-notifications.ts  # Push notification utilities
│   │   └── share.ts           # Web Share API utilities
│   └── types/
│       └── next-pwa.d.ts      # TypeScript declarations
└── scripts/
    └── generate-icons.js      # Icon generator
```

## Tech Stack

- Next.js 16
- TypeScript
- Tailwind CSS
- next-pwa (Workbox)
